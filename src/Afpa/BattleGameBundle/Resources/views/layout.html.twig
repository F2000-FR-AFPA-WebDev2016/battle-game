<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
        <title>{% block title %}Bataille NAPOLEONIENNE!{% endblock %}</title>
        {% block stylesheets %}
        {% endblock %}
        <link rel="stylesheet" type="text/css" href="{{ asset("bundles/afpabattlegame/css/styles.css") }}"/>
    </head>
    <body>
        <script>
            $(document).ready(function () {
                console.log('JQuery OK');
                // 1. Au survol du menu, afficher "Survol du logo !" dans le
                // paragraphe "monParagraphe"
                // -- On récupère l'élément et on se connecte à l'évènement 'click'
                $('#game').on('click', '.board_shoot td', function () {
                    selected_case = $(this);

                    $.ajax({
                        async: true,
                        type: "POST",
                        url: "game/action",
                        data: {
                            x: $(this).data('x'),
                            y: $(this).data('y'),
                        },
                        error: function (errorData) {
                            console.log(errorData);
                        },
                        success: function (data) {
                            console.log(data);
                            selected_case.css('background', 'red');
                            refresh();
                        }
                    });

                    // console.log($(this).data('x') + ' ' + $(this).data('y'));
                });

                // rafraichir la vue partielle
                function refresh() {
                    // selected_case = $(this);
                    $.ajax({
                        async: true,
                        type: "POST",
                        url: "game/view",
                        error: function (errorData) {
                            console.log(errorData);
                        },
                        success: function (data) {
                            $('#game').html(data);
                        }
                    });
                }

                // auto-refresh
                setInterval(refresh, 2000);
            });
        </script>
        <header>
            <img class ="logo" src="{{ asset("bundles/afpabattlegame/images/canon.gif") }}" />

            <marquee class= "bat" bgcolor=""WIDTH="50%" DIRECTION="LEFT" LOOP="-1">Bataille NAPOLEONNIENE</marquee>

            {% if app.request.session.get('oUser') is not null %}
                <div class ="logout">
                    Vous etes connecté : {{app.request.session.get('oUser').login}}<br>
                    <a href="{{ path('logout') }}"><input  type="submit" value="Déconnexion" /></a><br />
                </div>
            {% else %}
                <a href="{{ path('register') }}"><input class = "register" type="submit" value="Inscription" /></a><br />
                <a href="{{ path('login') }}"><input class = "login" type="submit" value="Connexion" /></a>
                {% endif %}


            <!-- On utilise la nouvelle balise HTML5 "nav" pour indiquer un élement de navigation dans notre site -->




            <nav>
                <ul>

                    <li><a href="{{ path('game_home') }}">Accueil</a></li>
                    <li><a href="{{ path('game_list') }}">Game room</a></li>



                </ul>
            </nav>
        </header>

        {% block body %}

        {% endblock %}

        <footer>
            <nav>
                <ul>
                    <li>YanRic 2016 @copyright</li>
                    <li>Qui sommes-nous ?</li>
                    <li><a href="contact.php">Contact</a></li>
                    <li><a href="https://fr.wikipedia.org/wiki/Bataille_navale_%28jeu%29">Règles</a></li>
                </ul>
            </nav>
        </footer>


    {% block javascripts %}{% endblock %}
</body>
</html>
